@model ObivtuaryMvcApi.Models.ObituaryDeleteViewModel

@{
    ViewData["Title"] = "Delete Obituary";
}

<h2>Delete Memorial</h2>

<div class="alert alert-warning">
    <h5><i class="fas fa-exclamation-triangle"></i> Confirm Deletion</h5>
    <p>Are you sure you want to permanently delete this memorial for <strong>@Model.Obituary.FullName</strong>?</p>
</div>

@if (User.IsInRole("Admin"))
{
    <div class="alert alert-info">
        <i class="fas fa-shield-alt"></i> You have administrator privileges and can delete any obituary.
    </div>
}
else if (Model.CanDelete)
{
    <div class="alert alert-success">
        <i class="fas fa-check-circle"></i> You are the User of this obituary and can delete it.
    </div>
}
else
{
    <div class="alert alert-danger">
        <i class="fas fa-exclamation-triangle"></i> You do not have permission to delete this obituary.
    </div>
}

<div class="card">
    <div class="card-header">
        <h4>Memorial Details</h4>
    </div>
    <div class="card-body">
        <h5>@Model.Obituary.FullName</h5>
        <p class="lead">
            <strong>@Model.Obituary.DateOfBirth.ToString("MMMM d, yyyy")</strong> â€” 
            <strong>@Model.Obituary.DateOfDeath.ToString("MMMM d, yyyy")</strong>
        </p>
        <p>@Model.Obituary.Biography</p>
        
        @if (Model.Obituary.Photo != null)
        {
            <div class="mt-3">
                <img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.Obituary.Photo)" 
        alt="Photo of @Model.Obituary.FullName" 
                     class="img-thumbnail" 
                     style="max-width: 200px;" />
            </div>
        }
    </div>
</div>

<div class="mt-4">
    @if (Model.CanDelete || User.IsInRole("Admin"))
    {
        <form asp-action="Delete" method="post" class="d-inline">
            <input type="hidden" asp-for="Obituary.Id" />
            <button type="submit" 
                    class="btn btn-danger me-2" 
                    onclick="return confirm('Are you absolutely sure you want to delete this memorial? This action cannot be undone.')">
                <i class="fas fa-trash"></i> Delete Memorial
            </button>
        </form>
    }
    else
    {
        <div class="alert alert-danger">
            <h6><i class="fas fa-ban"></i> Access Denied</h6>
            <p>You do not have permission to delete this memorial.</p>
        </div>
    }

    <a asp-action="Index" asp-controller="Home" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Back to Memorials
    </a>
</div>